#:import utils kivy.utils
ScreenManager:
    NavLayoutScreen:
        name: 'nav_screen'

<Login>
    name: 'login'
    usr_name: usr_name
    usr_pass: usr_pass

    canvas:
        Color:
            rgba: 0/255, 139/255, 139/255, 1
        Rectangle:
            pos: self.pos
            size: self.size

    FloatLayout:
        Image:
            source: 'LOGO.png'
            size_hint: .5, .30
            pos_hint: {'center_x': .5, 'center_y': .80}

        MDTextField:
            id: usr_name
            hint_text: 'Email'
            multiline: False
            write_tab: False
            color_mode: 'custom'
            line_color_focus: 1,1,1,1
            size_hint: .6, .1
            pos_hint:{'center_x': .50, 'center_y': .50}

        MDTextField:
            id: usr_pass
            hint_text: 'Password'
            multiline: False
            write_tab: False
            password: True
            color_mode: 'custom'
            line_color_focus: 1,1,1,1
            size_hint: .6, .1
            pos_hint:{'center_x': .50, 'center_y': .40}

        MDFillRoundFlatButton:
            text:'Log In'
            markup: True
            md_bg_color: 0/255,206/255,209/255, 1
            size_hint: .6, None
            pos_hint: {'center_x': .50, 'center_y': .30}
            on_release: root.usr_login()

        MDTextButton:
            text: '[color=#A9A9A9][b]Forgot Password[/b][/color]'
            markup: True
            pos_hint: {'center_x': .50, 'center_y': .20}

        MDTextButton:
            text: '[color=#A9A9A9][b]Sign Up[/b][/color]'
            markup: True
            pos_hint: {'center_x': .50, 'center_y': .15}
            size_hint: .2, .05
            on_release: app.show_screen('register')

        MDTextButton:
            text:'[color=#FFFFFF][b]Skip[/b][/color]'
            markup: True
            md_bg_color: 1,1,1,1
            size_hint: .2, .05
            pos_hint: {'center_x': .90, 'center_y': .97}
            on_release: app.show_screen('store')
     
<RegisterUser>
    name: 'register'
    usr_name: usr_name
    usr_pass1: usr_pass1
    usr_pass2: usr_pass2

    canvas:
        Color:
            rgba: 0/255, 139/255, 139/255, 1
        Rectangle:
            pos: self.pos
            size: self.size

    FloatLayout:
        Image:
            source: 'LOGO.png'
            size_hint: .5, .30
            pos_hint: {'center_x': .5, 'center_y': .80}

        MDTextField:
            id: usr_name
            hint_text: 'Email'
            multiline: False
            write_tab: False
            color_mode: 'custom'
            line_color_focus: 1,1,1,1
            size_hint: .6, .1
            pos_hint:{'center_x': .50, 'center_y': .55}

        MDTextField:
            id: usr_pass1
            hint_text: 'Password'
            multiline: False
            write_tab: False
            password: True
            color_mode: 'custom'
            line_color_focus: 1,1,1,1
            size_hint: .6, .1
            pos_hint:{'center_x': .50, 'center_y': .45}

        MDTextField:
            id: usr_pass2
            hint_text: 'Confirm Password'
            multiline: False
            write_tab: False
            password: True
            color_mode: 'custom'
            line_color_focus: 1,1,1,1
            size_hint: .6, .1
            pos_hint:{'center_x': .50, 'center_y': .35}

        MDFillRoundFlatButton:
            text:'Sign Up'
            markup: True
            md_bg_color: 0/255,206/255,209/255, 1
            size_hint: .6, None
            pos_hint: {'center_x': .50, 'center_y': .25}
            on_release: root.register()

        MDTextButton:
            text: '[color=#A9A9A9][b]or Log in[/b][/color]'
            markup: True
            pos_hint: {'center_x': .50, 'center_y': .15}
            size_hint: .2, .05
            on_release: app.show_screen('login', 'login')

        MDTextButton:
            text:'[color=#FFFFFF][b]Skip[/b][/color]'
            markup: True
            md_bg_color: 1,1,1,1
            size_hint: .2, .05
            pos_hint: {'center_x': .90, 'center_y': .97}
            on_release: app.show_screen('store')

<ForgotPassword>

<NavLayoutScreen@Screen>:
    MDNavigationLayout
        id: navigation_layout
        ScreenManager:
            Screen:
                BoxLayout:
                    orientation: 'vertical'

                    MDToolbar:
                        title: 'PCerve'
                        elevation: 10
                        md_bg_color: app.colors(2)
                        left_action_items: [['menu', lambda x: nav_drawer.set_state('open') ]]
                    ScreenManager:
                        id: manage

                        Store:
                            id: store
                            name: 'store'

                        ProductTypes:
                            id: product_type
                            name: 'product_type'

                        Products:
                            id: products
                            name: 'products'

                        ProductDetails:
                            id: details
                            name: 'details'

                        Profile:
                            id: profile
                            name: 'profile'

        MDNavigationDrawer:
            id: nav_drawer

            BoxLayout:
                orientation: 'vertical'
                padding: "8dp"
                spacing: '8dp'

                ScrollView:
                    MDList:

                        OneLineIconListItem:
                            text: 'Stores'
                            on_release:
                                app.show_screen('store')
                                nav_drawer.set_state('close')
#                                products.ids.content.clear_widgets()

                        OneLineIconListItem:
                            text: 'Profile'
                            on_release:
                                app.show_screen('profile')
                                nav_drawer.set_state('close')
#                                store.ids.content.clear_widgets()

                        OneLineIconListItem:
                            text: 'Reservation Cart'
                            on_release:
#                                store.ids.content.clear_widgets()

                        OneLineIconListItem:
                            text: 'Reservation Status'
                            on_release:
#                                store.ids.content.clear_widgets()

                        OneLineIconListItem:
                            text: 'Settings'
                            on_release:
#                                store.ids.content.clear_widgets()

                        OneLineIconListItem:
                            text: 'About Us'
                            on_release:
#                                store.ids.content.clear_widgets()

                        OneLineIconListItem:
                            text: 'Logout'
                            on_release:
#                                store.ids.content.clear_widgets()

<Profile>
    name: 'profile'

    bgcolor: 0/255, 139/255, 139/255, 1
    canvas:
        Color:
            rgba: self.bgcolor
        Rectangle:
            pos: self.pos
            size: self.size

<Store>
    name: 'store'

    canvas:
        Color:
            rgba: app.colors(0)
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        orientation: "vertical"
        spacing: "10dp"

        MDScrollViewRefreshLayout:
            id: refresh_layout
            refresh_callback: root.refresh_callback
            root_layout: root

            MDGridLayout:
                id: content
                adaptive_height: True
                cols: 1
                padding: '8dp'
                spacing: '6dp'

<Card>
    orientation: "vertical"
    size_hint: 1, None
    canvas:
        Color:
            rgba: app.colors(1)
        Rectangle:
            pos: self.pos
            size: self.size
    on_release:
        app.show_screen('product_type')

    MDBoxLayout:
        Image:
            source: root.icon
            size_hint: .5, 1
    MDBoxLayout:
        MDBoxLayout:
            cols: 1
            orientation: "vertical"
            size_hint: 1, 1
            MDLabel:
                text: root.title
                font_style: "H5"
                theme_text_color: 'Custom'
                halign: 'center'
                text_color: 25/255, 0, 0, 1

<TypesCard>
    orientation: "vertical"
    size_hint: 1, None
    canvas:
        Color:
            rgba: app.colors(1)
        Rectangle:
            pos: self.pos
            size: self.size

    on_release:
        app.show_screen('products')

    MDBoxLayout:
        cols: 1
        orientation: "vertical"
        size_hint: 1, 1
        MDLabel:
            text: root.name
            font_style: "H6"
            theme_text_color: 'Custom'
            halign: 'center'
            text_color: 25/255, 0, 0, 1

<ProductTypes>
    name: 'product_type'
    canvas:
        Color:
            rgba: app.colors(0)
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        orientation: 'vertical'

        MDScrollViewRefreshLayout:
            id: refresh_layout
            refresh_callback: root.refresh_callback
            root_layout: root

            MDGridLayout:
                id: content
                adaptive_height: True
                cols: 1
                padding: '8dp'
                spacing: '6dp'

<ProductCard>
    orientation: "vertical"
    size_hint: 1, None
    canvas:
        Color:
            rgba: app.colors(1)
        Rectangle:
            pos: self.pos
            size: self.size
    on_release:
        app.show_screen('details')

    MDBoxLayout:
        Image:
            source: root.image
            size_hint: .5, 1

        MDBoxLayout:
            cols: 1
            orientation: "vertical"
            size_hint: 1, 1
            MDLabel:
                text: root.name
                font_style: "Caption"
                theme_text_color: 'Custom'
                halign: 'center'
                text_color: 25/255, 0, 0, 1

<Products>
    name: 'products'
    canvas:
        Color:
            rgba: app.colors(0)
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        orientation: 'vertical'

        MDScrollViewRefreshLayout:
            id: refresh_layout
            refresh_callback: root.refresh_callback
            root_layout: root

            MDGridLayout:
                id: content
                adaptive_height: True
                cols: 1
                padding: '8dp'
                spacing: '6dp'

<DetailCard>
    orientation: "vertical"
    size_hint: 1, 100
    padding: '10dp'

    canvas:
        Color:
            rgba: app.colors(0)
        Rectangle:
            pos: self.pos
            size: self.size


    MDBoxLayout:
        cols: 2
        orientation: 'horizontal'
        size_hint_y: .7

        MDBoxLayout:
            cols: 1
            orientation: 'vertical'
            size_hint: 1, 1
            Image:
                source: root.image

        MDBoxLayout:
            cols:1
            orientation: 'vertical'

            MDLabel:
                padding_x: '8dp'
                size_hint_y: .6
                text: root.name
            MDLabel:
                padding_x: '8dp'
                size_hint_y: .2
                text: f'Php {root.price}'

            OneLineAvatarIconListItem:
                size_hint_y: .3
                text: str(root.count)

                IconLeftWidget:
                    icon: 'plus'
                    on_press:
                        root.count += 1
                IconRightWidget:
                    icon: 'minus'
                    on_press:
                        if root.count > 0: root.count -= 1
    MDSeparator:
        height: "1dp"
    MDBoxLayout:

        size_hint_y: .2
        cols: 2
        orientation: 'horizontal'
        MDLabel:
            text: 'Brand: ' + root.brand
            font_style: 'Subtitle1'
        MDLabel:
            font_style: 'Subtitle1'
            text: 'Stock(s): ' + str(root.stocks)

    MDSeparator:
        height: "1dp"
    MDLabel:
        size_hint_y: .1
        text: 'Descriptions:'
        font_style: 'Subtitle1'
    ScrollView:

        MDLabel:
            padding: (20,10)
            size_hint: 1, None
            size: self.texture_size
            text: root.description

    MDBoxLayout:
        cols: 4
        orientation: 'horizontal'
        size_hint: 1, .2
        MDBoxLayout:
        MDRaisedButton:
            text:'Back'
            markup: True
            theme_text_color: "Custom"
            text_color: 1, 1, 1, 1
            md_bg_color: app.colors(2)
            on_release:
                app.show_screen('products')
        MDBoxLayout:
            size_hint_x: .1
        MDRaisedButton:
            text:'Reserve'
            markup: True
            theme_text_color: "Custom"
            text_color: 1, 1, 1, 1
            md_bg_color: app.colors(2)
        MDBoxLayout:

<ProductDetails>
    name: 'details'
    canvas:
        Color:
            rgba: app.colors(0)
        Rectangle:
            pos: self.pos
            size: self.size
    ScrollView:
        MDGridLayout:
            id: content
            adaptive_height:
            cols: 1
            padding: '8dp'
            spacing: '6dp'

